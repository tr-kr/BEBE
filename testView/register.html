<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>회원가입</title>
</head>
<body>
  <h1>회원 가입</h1>
 <!-- <label for="userId">ID: </label>
  <input type="text" id="userId" name="userId">
  <button id="checkIDButton">ID중복체크</button><br> 
 -->

  <label for="inputemail">이메일: </label>
  <input type="text" id="email" name="email">
  <button id="checkEmailButton">이메일중복체크</button><br>
  
  <label for="password">비밀번호: </label>
  <input type="text" id="password" name="password"> /* 디버깅용, password타입 권장*/
  <br>

  <label for="name">이름: </label>
  <input type="text" id="name" name="name"><br>
  <label for="nickname">닉네임: </label>
  <input type="text" id="nickname" name="nickname">
  <button id="checkNicknameButton">닉네임중복체크</button><br>
  
 

  <label for="birth">생년월일: </label>
  <input type="date" id="birth" name="birth">



  <h1>연동 정보</h1>
  <label for="discord">discord: </label>
  <input type="text" id="discord" name="discord"><br>

  <label for="riot">riot: </label>
  <input type="text" id="riot" name="riot"><br>

  <label for="school">school: </label>
  <input type="text" id="school" name="schoold"><br><br><br>

  <button id="register">회원가입</button><br>



  <script>
    accountID = 0;
    
    document.addEventListener('DOMContentLoaded', () => {
      //const authemailButton = document.getElementById('authemailButton');


      //ID중복 확인
      // const checkIDButton = document.getElementById('checkIDButton');
      // const IDBox = document.getElementById('userId');
      // checkIDButton.addEventListener('click', ()=>{
      //   account = IDBox.value;
        
      //   const requestData = { account : account};

      //   fetch(`http://localhost:3000/api/signup/accountCheck`, {
      //     method: 'POST',
      //     headers: {
      //       'Content-Type': 'application/json'
      //     },
      //     body: JSON.stringify(requestData)
      //   })
      //     .then(response => response.json())
      //     .then(data => {
      //       alert(data.message);
      //       console.log(data);
      //       if(data.isSuccess === true)  IDBox.disabled = true;
      //     })
      //     .catch(error => console.error('Error:', error));
      // });




      //이메일중복 확인
      const checkEmailButton = document.getElementById('checkEmailButton');
      const EmailBox = document.getElementById('email');
      checkEmailButton.addEventListener('click', ()=>{
        email = EmailBox.value;
        
        const requestData = { email : email};

        fetch(`http://localhost:3000/api/signup/emailCheck`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(requestData)
        })
          .then(response => response.json())
          .then(data => {
            alert(data.message);
            console.log(data);
            if(data.isSuccess === true)  EmailBox.disabled = true;
          })
          .catch(error => console.error('Error:', error));

      });

      //닉네임중복 확인
      const checkNicknameButton = document.getElementById('checkNicknameButton');
      const NicknameBox = document.getElementById('nickname');
      checkNicknameButton.addEventListener('click', ()=>{
        nickname = NicknameBox.value;
        
        const requestData = { nickname : nickname};

        fetch(`http://localhost:3000/api/signup/nicknameCheck`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(requestData)
        })
          .then(response => response.json())
          .then(data => {
            alert(data.message);
            console.log(data);
            if(data.isSuccess === true)  NicknameBox.disabled = true;
          })
          .catch(error => console.error('Error:', error));

      });



      //회원가입
      const registerButton = document.getElementById('register');
      registerButton.addEventListener('click', ()=>{
        //account = document.getElementById('userId').value;
        password = document.getElementById('password').value;
        nickname = document.getElementById('nickname').value;
        name = document.getElementById('name').value;
        email = document.getElementById('email').value;
        birth = document.getElementById('birth').value;
        const requestData = {
          // account : account,
           password : password,
           nickname : nickname,
           name : name,
           email : email,
           birth : birth
          };

        fetch(`http://localhost:3000/api/signup`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(requestData)
        })
          .then(response => response.json())
          .then(data => {//회원가입 성공시
            alert(data.message);

            // if(data.isSuccess === true) 
            // fetch(`http://localhost:3000/api/verification/send-verification-email`, {
            //   method: 'POST',
            //   headers: {
            //     'Content-Type': 'application/json'
            //   },
            //   body: JSON.stringify({email : email})
            // })
            //   .then(response => response.json())
            //   .then(data => {
            //     alert(data.message);
            //     console.log(data);
            //     if(data.isSuccess === true)  EmailBox.disabled = true;
            //   })
            //   .catch(error => console.error('Error:', error));
            //이메일인

            //redirection('./');
          })
          .catch(error => console.error('Error:', error));
      });
      });

      
  </script>
</body>
</html>